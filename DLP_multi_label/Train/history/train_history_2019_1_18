
my_train_multi_labels_new_transfer.py

INTRA_CLASS_RATIO = 0.2
POSITIVE_WEIGHT_RATIO = 5
Xception-009-0.828.hdf5

class  0
[[71551  7524]
 [ 1021  8578]]
class  1
[[73156  3650]
 [  928 10940]]
class  2
[[83916   714]
 [  128  3916]]
class  3
[[88276   147]
 [    5   246]]
class  4
[[81349   601]
 [  125  6599]]
class  5
[[86728   792]
 [   41  1113]]
class  6
[[81336  2039]
 [  537  4762]]
class  7
[[84242  2802]
 [  111  1519]]
class  8
[[87161   755]
 [   19   739]]
class  9
[[81415   907]
 [  147  6205]]
class  10
[[77655  3996]
 [  548  6475]]
class  11
[[86634  1467]
 [   26   547]]
class  12
[[87230   415]
 [   19  1010]]
class  13
[[88387   108]
 [    1   178]]
class  14
[[88394   117]
 [    3   160]]
class  15
[[86563   445]
 [   10  1656]]
class  16
[[85582  1915]
 [   32  1145]]
class  17
[[88044    95]
 [    3   532]]
class  18
[[87752   376]
 [    5   541]]
class  19
[[88091   278]
 [    4   301]]
class  20
[[86757  1215]
 [   23   679]]
class  21
[[74488  7068]
 [  800  6318]]
class  22
[[85511  2528]
 [   65   570]]
class  23
[[86201  1789]
 [   36   648]]
class  24
[[85173  1981]
 [  133  1387]]
class  25
[[86576  1524]
 [   31   543]]
class  26
[[85475  1958]
 [   88  1153]]
class  27
[[81337  1147]
 [  224  5966]]
class  28
[[86763   502]
 [   17  1392]]
class  29
[[69443  1643]
 [  459 17129]]

INTRA_CLASS_RATIO = 0.2
POSITIVE_WEIGHT_RATIO = 5
InceptionResNetV2-008-0.826

class  0
[[72131  6944]
 [ 1054  8545]]
class  1
[[73481  3325]
 [  938 10930]]
class  2
[[83879   751]
 [  105  3939]]
class  3
[[88290   133]
 [    4   247]]
class  4
[[81319   631]
 [   97  6627]]
class  5
[[86636   884]
 [   31  1123]]
class  6
[[81574  1801]
 [  537  4762]]
class  7
[[84738  2306]
 [  118  1512]]
class  8
[[87293   623]
 [   19   739]]
class  9
[[81467   855]
 [  151  6201]]
class  10
[[77988  3663]
 [  625  6398]]
class  11
[[86786  1315]
 [   25   548]]
class  12
[[87200   445]
 [   19  1010]]
class  13
[[88411    84]
 [    0   179]]
class  14
[[88411   100]
 [    3   160]]
class  15
[[86603   405]
 [   10  1656]]
class  16
[[85674  1823]
 [   31  1146]]
class  17
[[88074    65]
 [    3   532]]
class  18
[[87847   281]
 [    6   540]]
class  19
[[88175   194]
 [    4   301]]
class  20
[[86825  1147]
 [   25   677]]
class  21
[[75549  6007]
 [  834  6284]]
class  22
[[85725  2314]
 [   45   590]]
class  23
[[86112  1878]
 [   37   647]]
class  24
[[85682  1472]
 [  127  1393]]
class  25
[[86853  1247]
 [   24   550]]
class  26
[[85667  1766]
 [   89  1152]]
class  27
[[81494   990]
 [  207  5983]]
class  28
[[86754   511]
 [    9  1400]]
class  29
[[69662  1424]
 [  495 17093]]

ensemble 2 models: 0.2,5
InceptionResNetV2-008-0.826.hdf5, Xception-009-0.828.hdf5
class  0
[[72155  6920]
 [  986  8613]]
class  1
[[73648  3158]
 [  860 11008]]
class  2
[[84003   627]
 [  110  3934]]
class  3
[[88325    98]
 [    4   247]]
class  4
[[81424   526]
 [  103  6621]]
class  5
[[86778   742]
 [   29  1125]]
class  6
[[81779  1596]
 [  517  4782]]
class  7
[[84785  2259]
 [  106  1524]]
class  8
[[87348   568]
 [   15   743]]
class  9
[[81504   818]
 [  142  6210]]
class  10
[[77963  3688]
 [  541  6482]]
class  11
[[86816  1285]
 [   18   555]]
class  12
[[87303   342]
 [   17  1012]]
class  13
[[88424    71]
 [    0   179]]
class  14
[[88426    85]
 [    3   160]]
class  15
[[86634   374]
 [    8  1658]]
class  16
[[85668  1829]
 [   24  1153]]
class  17
[[88080    59]
 [    2   533]]
class  18
[[87862   266]
 [    5   541]]
class  19
[[88212   157]
 [    2   303]]
class  20
[[86923  1049]
 [   22   680]]
class  21
[[75569  5987]
 [  803  6315]]
class  22
[[85976  2063]
 [   41   594]]
class  23
[[86431  1559]
 [   29   655]]
class  24
[[85669  1485]
 [  123  1397]]
class  25
[[86888  1212]
 [   22   552]]
class  26
[[85759  1674]
 [   76  1165]]
class  27
[[81497   987]
 [  207  5983]]
class  28
[[86790   475]
 [   11  1398]]
class  29
[[69668  1418]
 [  456 17132]]


INTRA_CLASS_RATIO = 0.15
POSITIVE_WEIGHT_RATIO = 2
收敛快了
Xception-009-0.833.hdf5


INTRA_CLASS_RATIO = 0.15
POSITIVE_WEIGHT_RATIO = 0.16
收敛快了
Xception-008-0.838.hdf5

class  0
[[76006  3069]
 [ 2419  7180]]
class  1
[[75119  1687]
 [ 1624 10244]]
class  2
[[84298   332]
 [  210  3834]]
class  3
[[88362    61]
 [    6   245]]
class  4
[[81691   259]
 [  196  6528]]
class  5
[[87131   389]
 [   67  1087]]
class  6
[[82784   591]
 [  899  4400]]
class  7
[[85988  1056]
 [  246  1384]]
class  8
[[87605   311]
 [   43   715]]
class  9
[[81900   422]
 [  263  6089]]
class  10
[[79604  2047]
 [ 1156  5867]]
class  11
[[87364   737]
 [   47   526]]
class  12
[[87472   173]
 [   45   984]]
class  13
[[88445    50]
 [    2   177]]
class  14
[[88464    47]
 [    6   157]]
class  15
[[86826   182]
 [   30  1636]]
class  16
[[86601   896]
 [   80  1097]]
class  17
[[88092    47]
 [    7   528]]
class  18
[[87975   153]
 [    9   537]]
class  19
[[88260   109]
 [    7   298]]
class  20
[[87428   544]
 [   60   642]]
class  21
[[79117  2439]
 [ 1517  5601]]
class  22
[[87150   889]
 [  132   503]]
class  23
[[87198   792]
 [   86   598]]
class  24
[[86546   608]
 [  257  1263]]
class  25
[[87381   719]
 [   72   502]]
class  26
[[86375  1058]
 [  167  1074]]
class  27
[[81868   616]
 [  344  5846]]
class  28
[[86974   291]
 [   26  1383]]
class  29
[[70425   661]
 [  846 16742]]


INTRA_CLASS_RATIO = 0.2  # inter class balanced
POSITIVE_WEIGHT_RATIO = 6  # positive ratio
ensemble 2 models: InceptionResNetV2-008-0.824.hdf5, Xception-009-0.825.hdf5

class  0
[[71112  7963]
 [  781  8818]]
class  1
[[73445  3361]
 [  804 11064]]
class  2
[[83810   820]
 [   95  3949]]
class  3
[[88307   116]
 [    4   247]]
class  4
[[81323   627]
 [   84  6640]]
class  5
[[86717   803]
 [   29  1125]]
class  6
[[81530  1845]
 [  479  4820]]
class  7
[[84507  2537]
 [   94  1536]]
class  8
[[87278   638]
 [   15   743]]
class  9
[[81378   944]
 [  132  6220]]
class  10
[[77466  4185]
 [  445  6578]]
class  11
[[86673  1428]
 [   20   553]]
class  12
[[87318   327]
 [   15  1014]]
class  13
[[88416    79]
 [    0   179]]
class  14
[[88413    98]
 [    4   159]]
class  15
[[86571   437]
 [    7  1659]]
class  16
[[85420  2077]
 [   20  1157]]
class  17
[[88076    63]
 [    1   534]]
class  18
[[87791   337]
 [    4   542]]
class  19
[[88189   180]
 [    3   302]]
class  20
[[86849  1123]
 [   22   680]]
class  21
[[74438  7118]
 [  683  6435]]
class  22
[[85823  2216]
 [   40   595]]
class  23
[[86240  1750]
 [   24   660]]
class  24
[[85524  1630]
 [  113  1407]]
class  25
[[86697  1403]
 [   24   550]]
class  26
[[85657  1776]
 [   72  1169]]
class  27
[[81382  1102]
 [  176  6014]]
class  28
[[86772   493]
 [   10  1399]]
class  29
[[69575  1511]
 [  448 17140]]


INTRA_CLASS_RATIO = 0.1  # inter class balanced  previous 0.2
POSITIVE_WEIGHT_RATIO = 3.5  # positive ratio  previous 5

class  0
[[73797  5278]
 [ 1110  8489]]
class  1
[[74281  1619]
 [  815 11959]]
class  2
[[84160   361]
 [   86  4067]]
class  3
[[88386    31]
 [    4   253]]
class  4
[[81661   289]
 [   91  6633]]
class  5
[[87037   411]
 [   28  1198]]
class  6
[[82339   879]
 [  469  4987]]
class  7
[[85792  1136]
 [   97  1649]]
class  8
[[87659   257]
 [   14   744]]
class  9
[[81798   524]
 [  158  6194]]
class  10
[[78861  2411]
 [  625  6777]]
class  11
[[87411   690]
 [   17   556]]
class  12
[[87447   153]
 [   15  1059]]
class  13
[[88474    21]
 [    1   178]]
class  14
[[88488    23]
 [    4   159]]
class  15
[[86755   253]
 [    6  1660]]
class  16
[[86312  1153]
 [   30  1179]]
class  17
[[88109    22]
 [    3   540]]
class  18
[[88000   128]
 [    6   540]]
class  19
[[88321    48]
 [    5   300]]
class  20
[[87457   515]
 [   19   683]]
class  21
[[77999  3433]
 [  938  6304]]
class  22
[[86475   878]
 [   61  1260]]
class  23
[[86832   720]
 [   22  1100]]
class  24
[[86389   765]
 [  125  1395]]
class  25
[[87051   539]
 [   21  1063]]
class  26
[[86089   668]
 [   72  1845]]
class  27
[[81490   509]
 [  140  6535]]
class  28
[[86855   217]
 [    8  1594]]
class  29
[[69903   704]
 [  421 17646]]